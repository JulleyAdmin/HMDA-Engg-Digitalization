<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stage 6: Quality Control & Monitoring - HMDA PES</title>
    <link rel="stylesheet" href="shared/styles.css">
    <link rel="stylesheet" href="shared/feedback-system.css">
    <style>
        .quality-overview {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border: 1px solid #f59e0b;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
        }
        
        .quality-overview h3 {
            color: #92400e;
            margin-bottom: 15px;
        }
        
        .quality-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .metric-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #fbbf24;
            text-align: center;
        }
        
        .metric-value {
            font-size: 2rem;
            font-weight: bold;
            color: #1e293b;
            margin: 10px 0;
        }
        
        .metric-label {
            font-size: 0.875rem;
            color: #64748b;
        }
        
        .qc-levels {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin: 20px 0;
        }
        
        .qc-level-card {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 20px;
            position: relative;
            overflow: hidden;
        }
        
        .qc-level-card.completed {
            border-color: #059669;
            background: #f0fdf4;
        }
        
        .qc-level-card.in-progress {
            border-color: #3b82f6;
            background: #eff6ff;
        }
        
        .qc-level-card.issues {
            border-color: #ef4444;
            background: #fef2f2;
        }
        
        .qc-level-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .qc-level-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #1e293b;
        }
        
        .qc-level-status {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .status-completed {
            background: #059669;
            color: white;
        }
        
        .status-in-progress {
            background: #3b82f6;
            color: white;
        }
        
        .status-issues {
            background: #ef4444;
            color: white;
        }
        
        .test-results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .test-result-card {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 15px;
            position: relative;
        }
        
        .test-result-card.passed {
            border-left: 4px solid #059669;
        }
        
        .test-result-card.failed {
            border-left: 4px solid #ef4444;
        }
        
        .test-result-card.pending {
            border-left: 4px solid #f59e0b;
        }
        
        .test-name {
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 8px;
        }
        
        .test-status {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 500;
        }
        
        .test-passed {
            background: #dcfce7;
            color: #166534;
        }
        
        .test-failed {
            background: #fee2e2;
            color: #991b1b;
        }
        
        .test-pending {
            background: #fef3c7;
            color: #92400e;
        }
        
        .quality-rating-section {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            padding: 25px;
            margin: 20px 0;
        }
        
        .rating-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .rating-item {
            text-align: center;
        }
        
        .rating-label {
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 10px;
            display: block;
        }
        
        .rating-stars {
            display: flex;
            justify-content: center;
            gap: 5px;
            margin-bottom: 10px;
        }
        
        .star {
            font-size: 24px;
            color: #e2e8f0;
            cursor: pointer;
            transition: color 0.2s;
        }
        
        .star.filled {
            color: #f59e0b;
        }
        
        .star:hover {
            color: #f59e0b;
        }
        
        .non-conformance-tracker {
            background: #fef2f2;
            border: 2px solid #fca5a5;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .nc-summary {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .nc-stat {
            background: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #fecaca;
        }
        
        .nc-stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #1e293b;
        }
        
        .nc-stat-label {
            font-size: 0.875rem;
            color: #64748b;
            margin-top: 5px;
        }
        
        .documentation-status {
            background: #f0f9ff;
            border: 1px solid #0284c7;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .doc-checklist {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 15px;
        }
        
        .doc-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            background: white;
            border-radius: 6px;
            border: 1px solid #e0f2fe;
        }
        
        .doc-item input[type="checkbox"] {
            width: 20px;
            height: 20px;
        }
        
        .performance-chart {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-style: italic;
            color: #64748b;
        }
        
        .remediation-section {
            background: #fffbeb;
            border: 1px solid #fbbf24;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .remediation-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .remediation-status {
            display: inline-block;
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 500;
            background: #f59e0b;
            color: white;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="form-header">
            <div class="form-title">
                <h1>Stage 6: Quality Control & Monitoring</h1>
                <p>Implement three-tier quality assurance and monitor compliance</p>
            </div>
            <div class="form-meta">
                <div class="meta-item">
                    <span class="meta-label">Project Code</span>
                    <span class="meta-value">HMDA/EE/2025/0001</span>
                </div>
                <div class="meta-item">
                    <span class="meta-label">Stage</span>
                    <span class="meta-value">6 of 9</span>
                </div>
                <div class="meta-item">
                    <span class="meta-label">Status</span>
                    <span class="meta-value status-active">In Progress</span>
                </div>
            </div>
        </div>

        <div class="progress-tracker">
            <div class="progress-step completed">1. Conceptualization</div>
            <div class="progress-step completed">2. DPR & Approvals</div>
            <div class="progress-step completed">3. Tendering</div>
            <div class="progress-step completed">4. Contract Award</div>
            <div class="progress-step completed">5. Execution</div>
            <div class="progress-step active">6. Quality Control</div>
            <div class="progress-step">7. Testing</div>
            <div class="progress-step">8. Closure</div>
            <div class="progress-step">9. DLP & O&M</div>
        </div>

        <form id="stage6Form" class="stage-form">
            <!-- Project Status Overview -->
            <div class="form-section">
                <h2>Project Status Overview</h2>
                <div class="quality-overview">
                    <h3>Quality Control Dashboard</h3>
                    <div class="quality-metrics">
                        <div class="metric-card">
                            <div class="metric-label">Project Code</div>
                            <div class="metric-value" style="font-size: 1rem;">HMDA/EE/2025/0001</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-label">Physical Progress</div>
                            <div class="metric-value">42%</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-label">Quality Status</div>
                            <div class="metric-value" style="font-size: 1rem; color: #f59e0b;">Under QC</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-label">Critical Issues</div>
                            <div class="metric-value" style="color: #ef4444;">2</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Three-Tier Quality Control -->
            <div class="form-section">
                <h2>Three-Tier Quality Control System</h2>
                <div class="qc-levels">
                    <div class="qc-level-card completed">
                        <div class="qc-level-header">
                            <h3 class="qc-level-title">Level 1: Contractor QC</h3>
                            <span class="qc-level-status status-completed">Completed</span>
                        </div>
                        <div class="form-group">
                            <label for="level1QCStatus">QC Status <span class="required">*</span></label>
                            <select id="level1QCStatus" name="level1QCStatus" required>
                                <option value="Not Started">Not Started</option>
                                <option value="In Progress">In Progress</option>
                                <option value="Completed" selected>Completed</option>
                                <option value="Issues Identified">Issues Identified</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="level1QCDate">Completion Date</label>
                            <input type="date" id="level1QCDate" name="level1QCDate" value="2025-01-10">
                        </div>
                        <div class="form-group">
                            <label for="level1Issues">Issues Count</label>
                            <input type="number" id="level1Issues" name="level1Issues" value="5" min="0">
                        </div>
                    </div>

                    <div class="qc-level-card in-progress">
                        <div class="qc-level-header">
                            <h3 class="qc-level-title">Level 2: Consultant QC</h3>
                            <span class="qc-level-status status-in-progress">In Progress</span>
                        </div>
                        <div class="form-group">
                            <label for="level2QCStatus">QC Status <span class="required">*</span></label>
                            <select id="level2QCStatus" name="level2QCStatus" required>
                                <option value="Not Started">Not Started</option>
                                <option value="In Progress" selected>In Progress</option>
                                <option value="Completed">Completed</option>
                                <option value="Issues Identified">Issues Identified</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="level2QCDate">Completion Date</label>
                            <input type="date" id="level2QCDate" name="level2QCDate">
                        </div>
                        <div class="form-group">
                            <label for="level2Issues">Issues Count</label>
                            <input type="number" id="level2Issues" name="level2Issues" value="3" min="0">
                        </div>
                    </div>

                    <div class="qc-level-card">
                        <div class="qc-level-header">
                            <h3 class="qc-level-title">Level 3: HMDA QC</h3>
                            <span class="qc-level-status" style="background: #6b7280; color: white;">Not Started</span>
                        </div>
                        <div class="form-group">
                            <label for="level3QCStatus">QC Status <span class="required">*</span></label>
                            <select id="level3QCStatus" name="level3QCStatus" required>
                                <option value="Not Started" selected>Not Started</option>
                                <option value="In Progress">In Progress</option>
                                <option value="Completed">Completed</option>
                                <option value="Issues Identified">Issues Identified</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="level3QCDate">Completion Date</label>
                            <input type="date" id="level3QCDate" name="level3QCDate">
                        </div>
                        <div class="form-group">
                            <label for="level3Issues">Issues Count</label>
                            <input type="number" id="level3Issues" name="level3Issues" value="0" min="0">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Material Testing & Approval -->
            <div class="form-section">
                <h2>Material Testing & Approval</h2>
                <div class="test-results-grid">
                    <div class="test-result-card passed">
                        <div class="test-name">Concrete Test</div>
                        <select id="concreteTestStatus" name="concreteTestStatus" required>
                            <option value="All Tests Passed" selected>All Tests Passed</option>
                            <option value="Tests Pending">Tests Pending</option>
                            <option value="Some Tests Failed">Some Tests Failed</option>
                        </select>
                        <span class="test-status test-passed">PASSED</span>
                    </div>
                    
                    <div class="test-result-card passed">
                        <div class="test-name">Steel Test</div>
                        <select id="steelTestStatus" name="steelTestStatus" required>
                            <option value="All Tests Passed" selected>All Tests Passed</option>
                            <option value="Tests Pending">Tests Pending</option>
                            <option value="Some Tests Failed">Some Tests Failed</option>
                        </select>
                        <span class="test-status test-passed">PASSED</span>
                    </div>
                    
                    <div class="test-result-card pending">
                        <div class="test-name">Aggregate Test</div>
                        <select id="aggregateTestStatus" name="aggregateTestStatus" required>
                            <option value="All Tests Passed">All Tests Passed</option>
                            <option value="Tests Pending" selected>Tests Pending</option>
                            <option value="Some Tests Failed">Some Tests Failed</option>
                        </select>
                        <span class="test-status test-pending">PENDING</span>
                    </div>
                    
                    <div class="test-result-card passed">
                        <div class="test-name">Cement Test</div>
                        <select id="cementTestStatus" name="cementTestStatus" required>
                            <option value="All Tests Passed" selected>All Tests Passed</option>
                            <option value="Tests Pending">Tests Pending</option>
                            <option value="Some Tests Failed">Some Tests Failed</option>
                        </select>
                        <span class="test-status test-passed">PASSED</span>
                    </div>
                    
                    <div class="test-result-card failed">
                        <div class="test-name">Pavement Material Test</div>
                        <select id="pavementTestStatus" name="pavementTestStatus">
                            <option value="All Tests Passed">All Tests Passed</option>
                            <option value="Tests Pending">Tests Pending</option>
                            <option value="Some Tests Failed" selected>Some Tests Failed</option>
                            <option value="Not Applicable">Not Applicable</option>
                        </select>
                        <span class="test-status test-failed">FAILED</span>
                    </div>
                    
                    <div class="test-result-card passed">
                        <div class="test-name">Water Test</div>
                        <select id="waterTestStatus" name="waterTestStatus" required>
                            <option value="Test Passed" selected>Test Passed</option>
                            <option value="Test Pending">Test Pending</option>
                            <option value="Test Failed">Test Failed</option>
                        </select>
                        <span class="test-status test-passed">PASSED</span>
                    </div>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="totalTestsPerformed">Total Tests Performed</label>
                        <input type="number" id="totalTestsPerformed" name="totalTestsPerformed" value="24" readonly>
                    </div>
                    <div class="form-group">
                        <label for="testPassPercentage">Test Pass Percentage</label>
                        <input type="number" id="testPassPercentage" name="testPassPercentage" value="83.33" readonly>
                    </div>
                </div>
            </div>

            <!-- Workmanship Quality Assessment -->
            <div class="form-section">
                <h2>Workmanship Quality Assessment</h2>
                <div class="quality-rating-section">
                    <h3>Quality Ratings</h3>
                    <div class="rating-grid">
                        <div class="rating-item">
                            <label class="rating-label" for="structuralQuality">Structural Work Quality</label>
                            <div class="rating-stars" data-rating="4">
                                <span class="star filled">★</span>
                                <span class="star filled">★</span>
                                <span class="star filled">★</span>
                                <span class="star filled">★</span>
                                <span class="star">★</span>
                            </div>
                            <select id="structuralQuality" name="structuralQuality" required>
                                <option value="Excellent">Excellent</option>
                                <option value="Good" selected>Good</option>
                                <option value="Satisfactory">Satisfactory</option>
                                <option value="Poor">Poor</option>
                                <option value="Unacceptable">Unacceptable</option>
                            </select>
                        </div>
                        
                        <div class="rating-item">
                            <label class="rating-label" for="finishingQuality">Finishing Work Quality</label>
                            <div class="rating-stars" data-rating="3">
                                <span class="star filled">★</span>
                                <span class="star filled">★</span>
                                <span class="star filled">★</span>
                                <span class="star">★</span>
                                <span class="star">★</span>
                            </div>
                            <select id="finishingQuality" name="finishingQuality" required>
                                <option value="Excellent">Excellent</option>
                                <option value="Good">Good</option>
                                <option value="Satisfactory" selected>Satisfactory</option>
                                <option value="Poor">Poor</option>
                                <option value="Unacceptable">Unacceptable</option>
                            </select>
                        </div>
                        
                        <div class="rating-item">
                            <label class="rating-label" for="mechanicalQuality">Mechanical Work Quality</label>
                            <div class="rating-stars" data-rating="4">
                                <span class="star filled">★</span>
                                <span class="star filled">★</span>
                                <span class="star filled">★</span>
                                <span class="star filled">★</span>
                                <span class="star">★</span>
                            </div>
                            <select id="mechanicalQuality" name="mechanicalQuality">
                                <option value="Excellent">Excellent</option>
                                <option value="Good" selected>Good</option>
                                <option value="Satisfactory">Satisfactory</option>
                                <option value="Poor">Poor</option>
                                <option value="Unacceptable">Unacceptable</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>
                        
                        <div class="rating-item">
                            <label class="rating-label" for="electricalQuality">Electrical Work Quality</label>
                            <div class="rating-stars" data-rating="4">
                                <span class="star filled">★</span>
                                <span class="star filled">★</span>
                                <span class="star filled">★</span>
                                <span class="star filled">★</span>
                                <span class="star">★</span>
                            </div>
                            <select id="electricalQuality" name="electricalQuality">
                                <option value="Excellent">Excellent</option>
                                <option value="Good" selected>Good</option>
                                <option value="Satisfactory">Satisfactory</option>
                                <option value="Poor">Poor</option>
                                <option value="Unacceptable">Unacceptable</option>
                                <option value="Not Applicable">Not Applicable</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group" style="margin-top: 20px;">
                        <label for="overallWorkmanship">Overall Workmanship Rating</label>
                        <input type="text" id="overallWorkmanship" name="overallWorkmanship" value="Good (3.75/5)" readonly>
                    </div>
                </div>
            </div>

            <!-- Specification Compliance -->
            <div class="form-section">
                <h2>Specification Compliance</h2>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="dimensionalCompliance">Dimensional Compliance <span class="required">*</span></label>
                        <select id="dimensionalCompliance" name="dimensionalCompliance" required>
                            <option value="Fully Compliant" selected>Fully Compliant</option>
                            <option value="Minor Deviations">Minor Deviations</option>
                            <option value="Major Deviations">Major Deviations</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="materialCompliance">Material Specification Compliance <span class="required">*</span></label>
                        <select id="materialCompliance" name="materialCompliance" required>
                            <option value="Fully Compliant">Fully Compliant</option>
                            <option value="Minor Deviations" selected>Minor Deviations</option>
                            <option value="Major Deviations">Major Deviations</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="constructionCompliance">Construction Method Compliance <span class="required">*</span></label>
                        <select id="constructionCompliance" name="constructionCompliance" required>
                            <option value="Fully Compliant" selected>Fully Compliant</option>
                            <option value="Minor Deviations">Minor Deviations</option>
                            <option value="Major Deviations">Major Deviations</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="safetyCompliance">Safety Standard Compliance <span class="required">*</span></label>
                        <select id="safetyCompliance" name="safetyCompliance" required>
                            <option value="Fully Compliant">Fully Compliant</option>
                            <option value="Minor Deviations" selected>Minor Deviations</option>
                            <option value="Major Deviations">Major Deviations</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="environmentalCompliance">Environmental Compliance <span class="required">*</span></label>
                        <select id="environmentalCompliance" name="environmentalCompliance" required>
                            <option value="Fully Compliant" selected>Fully Compliant</option>
                            <option value="Minor Deviations">Minor Deviations</option>
                            <option value="Major Deviations">Major Deviations</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="codeCompliance">Code Compliance (IS/IRC) <span class="required">*</span></label>
                        <select id="codeCompliance" name="codeCompliance" required>
                            <option value="Fully Compliant" selected>Fully Compliant</option>
                            <option value="Minor Deviations">Minor Deviations</option>
                            <option value="Major Deviations">Major Deviations</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Non-Conformance Management -->
            <div class="form-section">
                <h2>Non-Conformance Management</h2>
                <div class="non-conformance-tracker">
                    <h3>Non-Conformance Summary</h3>
                    <div class="nc-summary">
                        <div class="nc-stat">
                            <div class="nc-stat-value">8</div>
                            <div class="nc-stat-label">Total NCRs</div>
                        </div>
                        <div class="nc-stat">
                            <div class="nc-stat-value" style="color: #ef4444;">2</div>
                            <div class="nc-stat-label">Critical</div>
                        </div>
                        <div class="nc-stat">
                            <div class="nc-stat-value" style="color: #f59e0b;">3</div>
                            <div class="nc-stat-label">Major</div>
                        </div>
                        <div class="nc-stat">
                            <div class="nc-stat-value" style="color: #059669;">3</div>
                            <div class="nc-stat-label">Minor</div>
                        </div>
                    </div>
                    
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="nonConformancesIdentified">Non-Conformances Identified</label>
                            <input type="number" id="nonConformancesIdentified" name="nonConformancesIdentified" value="8" min="0">
                        </div>
                        <div class="form-group">
                            <label for="criticalNonConformances">Critical Non-Conformances</label>
                            <input type="number" id="criticalNonConformances" name="criticalNonConformances" value="2" min="0">
                        </div>
                        <div class="form-group">
                            <label for="majorNonConformances">Major Non-Conformances</label>
                            <input type="number" id="majorNonConformances" name="majorNonConformances" value="3" min="0">
                        </div>
                        <div class="form-group">
                            <label for="minorNonConformances">Minor Non-Conformances</label>
                            <input type="number" id="minorNonConformances" name="minorNonConformances" value="3" min="0">
                        </div>
                        <div class="form-group">
                            <label for="rectifiedNonConformances">Rectified Non-Conformances</label>
                            <input type="number" id="rectifiedNonConformances" name="rectifiedNonConformances" value="5" min="0">
                        </div>
                        <div class="form-group">
                            <label for="pendingNonConformances">Pending Non-Conformances</label>
                            <input type="number" id="pendingNonConformances" name="pendingNonConformances" value="3" readonly>
                        </div>
                        <div class="form-group">
                            <label for="averageResolutionTime">Average Resolution Time (Days)</label>
                            <input type="number" id="averageResolutionTime" name="averageResolutionTime" value="4.5" readonly>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quality Documentation -->
            <div class="form-section">
                <h2>Quality Documentation</h2>
                <div class="documentation-status">
                    <h3>Documentation Checklist</h3>
                    <div class="doc-checklist">
                        <div class="doc-item">
                            <input type="checkbox" id="qcChecklist" name="qcChecklist" checked>
                            <label for="qcChecklist">QC Checklists Complete</label>
                        </div>
                        <div class="doc-item">
                            <input type="checkbox" id="testCertificates" name="testCertificates" checked>
                            <label for="testCertificates">Test Certificates Received</label>
                        </div>
                        <div class="doc-item">
                            <input type="checkbox" id="inspectionReports" name="inspectionReports">
                            <label for="inspectionReports">Inspection Reports Complete</label>
                        </div>
                        <div class="doc-item">
                            <input type="checkbox" id="photographicEvidence" name="photographicEvidence" checked>
                            <label for="photographicEvidence">Photographic Evidence Adequate</label>
                        </div>
                    </div>
                    
                    <div class="form-grid" style="margin-top: 20px;">
                        <div class="form-group">
                            <label for="qcChecklistStatus">QC Checklist Status <span class="required">*</span></label>
                            <select id="qcChecklistStatus" name="qcChecklistStatus" required>
                                <option value="Complete" selected>Complete</option>
                                <option value="Incomplete">Incomplete</option>
                                <option value="Under Review">Under Review</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="testCertificatesStatus">Test Certificates Status <span class="required">*</span></label>
                            <select id="testCertificatesStatus" name="testCertificatesStatus" required>
                                <option value="All Received" selected>All Received</option>
                                <option value="Partial">Partial</option>
                                <option value="Pending">Pending</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="inspectionReportsStatus">Inspection Reports Status <span class="required">*</span></label>
                            <select id="inspectionReportsStatus" name="inspectionReportsStatus" required>
                                <option value="All Complete">All Complete</option>
                                <option value="Partial" selected>Partial</option>
                                <option value="Pending">Pending</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="photographicEvidenceStatus">Photographic Evidence Status <span class="required">*</span></label>
                            <select id="photographicEvidenceStatus" name="photographicEvidenceStatus" required>
                                <option value="Adequate" selected>Adequate</option>
                                <option value="Insufficient">Insufficient</option>
                                <option value="Missing">Missing</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="qualityRecordsArchival">Quality Records Archival</label>
                            <select id="qualityRecordsArchival" name="qualityRecordsArchival">
                                <option value="">Select Status</option>
                                <option value="Digital Archive Complete">Digital Archive Complete</option>
                                <option value="Partial Archival" selected>Partial Archival</option>
                                <option value="Pending">Pending</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Remedial Actions -->
            <div class="form-section">
                <h2>Remedial Actions</h2>
                <div class="remediation-section">
                    <div class="remediation-header">
                        <h3>Remediation Requirements</h3>
                        <span class="remediation-status">Minor Remediation Required</span>
                    </div>
                    
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="remediationRequired">Remediation Required <span class="required">*</span></label>
                            <select id="remediationRequired" name="remediationRequired" required>
                                <option value="No Remediation">No Remediation</option>
                                <option value="Minor Remediation" selected>Minor Remediation</option>
                                <option value="Major Remediation">Major Remediation</option>
                                <option value="Complete Rework">Complete Rework</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="remediationTimeline">Remediation Timeline (Days)</label>
                            <input type="number" id="remediationTimeline" name="remediationTimeline" value="15" min="0">
                        </div>
                        <div class="form-group">
                            <label for="remediationCost">Remediation Cost (₹ Lakhs)</label>
                            <input type="number" id="remediationCost" name="remediationCost" value="2.5" min="0" step="0.01">
                        </div>
                        <div class="form-group">
                            <label for="remediationResponsibility">Remediation Responsibility</label>
                            <select id="remediationResponsibility" name="remediationResponsibility">
                                <option value="">Select Responsibility</option>
                                <option value="Contractor" selected>Contractor</option>
                                <option value="HMDA">HMDA</option>
                                <option value="Shared">Shared</option>
                                <option value="Third Party">Third Party</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="remediationStatus">Remediation Status</label>
                            <select id="remediationStatus" name="remediationStatus">
                                <option value="">Select Status</option>
                                <option value="Not Started">Not Started</option>
                                <option value="In Progress" selected>In Progress</option>
                                <option value="Completed">Completed</option>
                                <option value="On Hold">On Hold</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group full-width">
                        <label for="remediationPlan">Remediation Plan</label>
                        <textarea id="remediationPlan" name="remediationPlan" rows="3" placeholder="Detailed plan for remedial actions">1. Replace failed pavement material in chainage 1+200 to 1+350
2. Rectify minor dimensional deviations in culvert structures
3. Re-test concrete strength for disputed batches
4. Additional safety barriers at identified locations</textarea>
                    </div>
                </div>
            </div>

            <!-- Third Party Inspections -->
            <div class="form-section">
                <h2>Third Party Inspections</h2>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="externalQARequired">External QA Required <span class="required">*</span></label>
                        <select id="externalQARequired" name="externalQARequired" required>
                            <option value="Yes" selected>Yes</option>
                            <option value="No">No</option>
                            <option value="Under Evaluation">Under Evaluation</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="externalInspectionAgency">External Inspection Agency</label>
                        <input type="text" id="externalInspectionAgency" name="externalInspectionAgency" value="M/s Quality Assurance Consultants Pvt Ltd">
                    </div>
                    <div class="form-group">
                        <label for="externalInspectionDate">External Inspection Date</label>
                        <input type="date" id="externalInspectionDate" name="externalInspectionDate" value="2025-01-15">
                    </div>
                    <div class="form-group">
                        <label for="externalInspectionReport">External Inspection Report</label>
                        <select id="externalInspectionReport" name="externalInspectionReport">
                            <option value="">Select Result</option>
                            <option value="Satisfactory">Satisfactory</option>
                            <option value="Conditional Approval" selected>Conditional Approval</option>
                            <option value="Rejected">Rejected</option>
                        </select>
                    </div>
                    <div class="form-group full-width">
                        <label for="externalRecommendations">External Recommendations</label>
                        <textarea id="externalRecommendations" name="externalRecommendations" rows="3" placeholder="Recommendations from external inspection">1. Improve documentation for material testing procedures
2. Enhance safety measures at work zones
3. Regular calibration of testing equipment recommended
4. Additional quality checks for critical structures</textarea>
                    </div>
                </div>
            </div>

            <!-- Quality Performance Metrics -->
            <div class="form-section">
                <h2>Quality Performance Metrics</h2>
                <div class="performance-chart">
                    Quality Performance Chart Placeholder - Real-time metrics visualization
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="qualityPerformanceIndex">Quality Performance Index</label>
                        <input type="number" id="qualityPerformanceIndex" name="qualityPerformanceIndex" value="78.5" readonly>
                        <span class="field-hint">Scale: 0-100</span>
                    </div>
                    <div class="form-group">
                        <label for="reworkPercentage">Rework Percentage</label>
                        <input type="number" id="reworkPercentage" name="reworkPercentage" value="3.2" readonly>
                        <span class="field-hint">Industry benchmark: <5%</span>
                    </div>
                    <div class="form-group">
                        <label for="firstTimeRightPercentage">First Time Right Percentage</label>
                        <input type="number" id="firstTimeRightPercentage" name="firstTimeRightPercentage" value="85.4" readonly>
                        <span class="field-hint">Target: >90%</span>
                    </div>
                    <div class="form-group">
                        <label for="qualityTrendAnalysis">Quality Trend Analysis</label>
                        <input type="text" id="qualityTrendAnalysis" name="qualityTrendAnalysis" value="Stable" readonly>
                    </div>
                    <div class="form-group">
                        <label for="benchmarkComparison">Benchmark Comparison</label>
                        <input type="text" id="benchmarkComparison" name="benchmarkComparison" value="At Benchmark" readonly>
                    </div>
                </div>
            </div>

            <!-- Quality Assurance Certification -->
            <div class="form-section">
                <h2>Quality Assurance Certification</h2>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="workQualityCertification">Work Quality Certification</label>
                        <select id="workQualityCertification" name="workQualityCertification">
                            <option value="">Select Status</option>
                            <option value="Certified">Certified</option>
                            <option value="Provisional" selected>Provisional</option>
                            <option value="Rejected">Rejected</option>
                            <option value="Pending">Pending</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="certificationDate">Certification Date</label>
                        <input type="date" id="certificationDate" name="certificationDate">
                    </div>
                    <div class="form-group">
                        <label for="certificationValidity">Certification Validity (Months)</label>
                        <input type="number" id="certificationValidity" name="certificationValidity" value="12" min="1" max="24">
                    </div>
                    <div class="form-group">
                        <label for="nextQualityReview">Next Quality Review Date</label>
                        <input type="date" id="nextQualityReview" name="nextQualityReview" value="2025-02-15" readonly>
                    </div>
                    <div class="form-group full-width">
                        <label for="certificationConditions">Certification Conditions</label>
                        <textarea id="certificationConditions" name="certificationConditions" rows="3" placeholder="Special conditions attached to certification">1. Complete pending NCR rectifications within 15 days
2. Submit revised test certificates for pavement materials
3. Implement additional safety measures as recommended
4. Monthly quality review meetings mandatory</textarea>
                    </div>
                </div>
            </div>

            <!-- Form Actions -->
            <div class="form-actions">
                <button type="button" class="btn-secondary">Save as Draft</button>
                <button type="button" class="btn-secondary">Previous Stage</button>
                <button type="submit" class="btn-primary">Update Quality Status</button>
            </div>
        </form>
    </div>

    <!-- Include feedback system -->
    <script src="shared/feedback-system.js"></script>
    <script>
        // Initialize feedback system
        document.addEventListener('DOMContentLoaded', function() {
            const feedbackSystem = new HMDAFeedbackSystem();
            
            // Update test status display based on selection
            const testSelects = document.querySelectorAll('.test-result-card select');
            testSelects.forEach(select => {
                select.addEventListener('change', function() {
                    const card = this.closest('.test-result-card');
                    const statusSpan = card.querySelector('.test-status');
                    const value = this.value;
                    
                    // Remove all classes
                    card.classList.remove('passed', 'failed', 'pending');
                    statusSpan.classList.remove('test-passed', 'test-failed', 'test-pending');
                    
                    // Add appropriate class
                    if (value.includes('Passed')) {
                        card.classList.add('passed');
                        statusSpan.classList.add('test-passed');
                        statusSpan.textContent = 'PASSED';
                    } else if (value.includes('Failed')) {
                        card.classList.add('failed');
                        statusSpan.classList.add('test-failed');
                        statusSpan.textContent = 'FAILED';
                    } else if (value.includes('Pending')) {
                        card.classList.add('pending');
                        statusSpan.classList.add('test-pending');
                        statusSpan.textContent = 'PENDING';
                    }
                    
                    // Recalculate test pass percentage
                    calculateTestPassPercentage();
                });
            });
            
            // Calculate test pass percentage
            function calculateTestPassPercentage() {
                const totalTests = testSelects.length;
                let passedTests = 0;
                
                testSelects.forEach(select => {
                    if (select.value.includes('Passed')) {
                        passedTests++;
                    }
                });
                
                const percentage = (passedTests / totalTests * 100).toFixed(2);
                document.getElementById('testPassPercentage').value = percentage;
            }
            
            // Update QC level card status
            const qcSelects = document.querySelectorAll('.qc-level-card select');
            qcSelects.forEach(select => {
                select.addEventListener('change', function() {
                    const card = this.closest('.qc-level-card');
                    const statusSpan = card.querySelector('.qc-level-status');
                    const value = this.value;
                    
                    // Remove all classes
                    card.classList.remove('completed', 'in-progress', 'issues');
                    statusSpan.classList.remove('status-completed', 'status-in-progress', 'status-issues');
                    
                    // Add appropriate class
                    if (value === 'Completed') {
                        card.classList.add('completed');
                        statusSpan.classList.add('status-completed');
                        statusSpan.textContent = 'Completed';
                    } else if (value === 'In Progress') {
                        card.classList.add('in-progress');
                        statusSpan.classList.add('status-in-progress');
                        statusSpan.textContent = 'In Progress';
                    } else if (value === 'Issues Identified') {
                        card.classList.add('issues');
                        statusSpan.classList.add('status-issues');
                        statusSpan.textContent = 'Issues Found';
                    } else {
                        statusSpan.style.background = '#6b7280';
                        statusSpan.style.color = 'white';
                        statusSpan.textContent = 'Not Started';
                    }
                });
            });
            
            // Calculate pending non-conformances
            function calculatePendingNC() {
                const total = parseInt(document.getElementById('nonConformancesIdentified').value) || 0;
                const rectified = parseInt(document.getElementById('rectifiedNonConformances').value) || 0;
                document.getElementById('pendingNonConformances').value = total - rectified;
            }
            
            document.getElementById('nonConformancesIdentified').addEventListener('input', calculatePendingNC);
            document.getElementById('rectifiedNonConformances').addEventListener('input', calculatePendingNC);
            
            // Update remediation status based on selection
            const remediationSelect = document.getElementById('remediationRequired');
            remediationSelect.addEventListener('change', function() {
                const statusSpan = document.querySelector('.remediation-status');
                const value = this.value;
                
                if (value === 'No Remediation') {
                    statusSpan.textContent = 'No Remediation Required';
                    statusSpan.style.background = '#059669';
                } else if (value === 'Minor Remediation') {
                    statusSpan.textContent = 'Minor Remediation Required';
                    statusSpan.style.background = '#f59e0b';
                } else if (value === 'Major Remediation') {
                    statusSpan.textContent = 'Major Remediation Required';
                    statusSpan.style.background = '#ef4444';
                } else if (value === 'Complete Rework') {
                    statusSpan.textContent = 'Complete Rework Required';
                    statusSpan.style.background = '#991b1b';
                }
            });
            
            // Interactive star rating
            const ratingContainers = document.querySelectorAll('.rating-stars');
            ratingContainers.forEach(container => {
                const stars = container.querySelectorAll('.star');
                stars.forEach((star, index) => {
                    star.addEventListener('click', function() {
                        const rating = index + 1;
                        container.setAttribute('data-rating', rating);
                        
                        // Update visual
                        stars.forEach((s, i) => {
                            if (i < rating) {
                                s.classList.add('filled');
                            } else {
                                s.classList.remove('filled');
                            }
                        });
                        
                        // Update corresponding select
                        const select = container.parentElement.querySelector('select');
                        if (rating === 5) select.value = 'Excellent';
                        else if (rating === 4) select.value = 'Good';
                        else if (rating === 3) select.value = 'Satisfactory';
                        else if (rating === 2) select.value = 'Poor';
                        else select.value = 'Unacceptable';
                        
                        // Recalculate overall rating
                        calculateOverallRating();
                    });
                });
            });
            
            // Calculate overall workmanship rating
            function calculateOverallRating() {
                const ratings = document.querySelectorAll('.rating-stars');
                let totalRating = 0;
                let count = 0;
                
                ratings.forEach(container => {
                    const rating = parseInt(container.getAttribute('data-rating')) || 0;
                    if (rating > 0) {
                        totalRating += rating;
                        count++;
                    }
                });
                
                if (count > 0) {
                    const average = (totalRating / count).toFixed(2);
                    let grade = 'Poor';
                    if (average >= 4.5) grade = 'Excellent';
                    else if (average >= 3.5) grade = 'Good';
                    else if (average >= 2.5) grade = 'Satisfactory';
                    else if (average >= 1.5) grade = 'Poor';
                    else grade = 'Unacceptable';
                    
                    document.getElementById('overallWorkmanship').value = `${grade} (${average}/5)`;
                }
            }
            
            // Form submission
            document.getElementById('stage6Form').addEventListener('submit', function(e) {
                e.preventDefault();
                
                // Check critical issues
                const criticalIssues = parseInt(document.getElementById('criticalNonConformances').value) || 0;
                const pendingNC = parseInt(document.getElementById('pendingNonConformances').value) || 0;
                
                if (criticalIssues > 0) {
                    if (!confirm(`There are ${criticalIssues} critical non-conformances. Are you sure you want to proceed?`)) {
                        return;
                    }
                }
                
                alert('Quality Control data updated successfully! Continue monitoring quality standards.');
            });
        });
    </script>
</body>
</html>